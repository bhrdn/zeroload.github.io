<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Funmail One of our employees has locked himself out of his account. can you help ‘john galt’ recover his password? And no snooping around his emails you hear.  Upon  running the binary given, user wil">
<meta property="og:type" content="article">
<meta property="og:title" content="TUCTF 2017 - Reverse Engineering Writeup">
<meta property="og:url" content="https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/index.html">
<meta property="og:site_name" content="Catousify">
<meta property="og:description" content="Funmail One of our employees has locked himself out of his account. can you help ‘john galt’ recover his password? And no snooping around his emails you hear.  Upon  running the binary given, user wil">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-10-16T17:54:22.653Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TUCTF 2017 - Reverse Engineering Writeup">
<meta name="twitter:description" content="Funmail One of our employees has locked himself out of his account. can you help ‘john galt’ recover his password? And no snooping around his emails you hear.  Upon  running the binary given, user wil">
    
    
        
          
              <link rel="shortcut icon" href="/img/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>TUCTF 2017 - Reverse Engineering Writeup</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Catousify" type="application/atom+xml" />
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/12/07/tpctf-2017-bad-encryption-writeup/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/11/24/agrihack-0x2-lift-rektorat-writeup/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&text=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&is_video=false&description=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=TUCTF 2017 - Reverse Engineering Writeup&body=Check out this article: https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&name=TUCTF 2017 - Reverse Engineering Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Funmail"><span class="toc-number">1.</span> <span class="toc-text">Funmail</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Funmail2-0"><span class="toc-number">2.</span> <span class="toc-text">Funmail2.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unknown"><span class="toc-number">3.</span> <span class="toc-text">Unknown</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Future"><span class="toc-number">4.</span> <span class="toc-text">Future</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        TUCTF 2017 - Reverse Engineering Writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Catousify</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-11-27T11:01:11.000Z" itemprop="datePublished">2017-11-27</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Funmail"><a href="#Funmail" class="headerlink" title="Funmail"></a>Funmail</h1><blockquote>
<p>One of our employees has locked himself out of his account. can you help ‘john galt’ recover his password? And no snooping around his emails you hear.</p>
</blockquote>
<p>Upon  running the binary given, user will be prompted to input username and password. The hints basically tells you everything. Use <code>john galt</code> as Username, then for password, use <code>ltrace ./funmail</code> to trace strcmp.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strcmp(&quot;idontknow&quot;, &quot;this-password-is-a-secret-to-eve&quot;...)       = -1</span><br></pre></td></tr></table></figure>
<p>ugh. Only small chunk of string is printed. To solve this use strings and grep for the password.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ strings ./funmail|grep password</span><br><span class="line">*Incorrect password</span><br><span class="line">this-password-is-a-secret-to-everyone!</span><br><span class="line">password</span><br></pre></td></tr></table></figure>
<p>So, <code>this-password-is-a-secret-to-everyone!</code> is the password. Now, run binary again.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">--Please login--</span><br><span class="line">Username: john glat</span><br><span class="line">*We have no users with the username: &apos;john glat&apos;</span><br><span class="line">--Please login--</span><br><span class="line">Username: john galt</span><br><span class="line">Password: this-password-is-a-secret-to-everyone!</span><br><span class="line">Welcome john galt!</span><br><span class="line">You have 1 unread email.</span><br><span class="line">1) Read Email</span><br><span class="line">2) Quit</span><br><span class="line">&gt;\&gt; 1</span><br><span class="line">\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-</span><br><span class="line">From:   Leeroy Jenkins</span><br><span class="line">To:     whoisjohngalt</span><br><span class="line">Subject: RE: I need a flag</span><br><span class="line"></span><br><span class="line">Hey John it&apos;s Leeroy.</span><br><span class="line">You were asking about a fun flag to use in your next challenge</span><br><span class="line">and I think I got one. Tell me what you think of:</span><br><span class="line">TUCTF&#123;d0n7\_h4rdc0d3\_p455w0rd5&#125;</span><br><span class="line">Get back to me as soon as you can. Thanks!</span><br><span class="line">\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-</span><br><span class="line"></span><br><span class="line">Flag : `TUCTF&#123;d0n7_h4rdc0d3_p455w0rd5&#125;`</span><br></pre></td></tr></table></figure></p>
<h1 id="Funmail2-0"><a href="#Funmail2-0" class="headerlink" title="Funmail2.0"></a>Funmail2.0</h1><blockquote>
<p>john galt is having some problems with his email again. But this time it’s not his fault. Can you help him?</p>
</blockquote>
<p>This challange is quite same with the first challange, except its tricky because even after input the right username and password, program will force exit. After sometime, I just realized that the sym.printFlag function is still there in the binary, but didnt get invoked. Solution, put break at the start then set rip (eip) to sym.printF;ag then continue. In radare2,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[0xf7739030]&gt; db sym.main</span><br><span class="line">[0xf775ab24]&gt; is ~Flag</span><br><span class="line">vaddr=0xf775a785 paddr=0x00000785 ord=053 fwd=NONE sz=302 bind=GLOBAL type=FUNC name=printFlag</span><br><span class="line">[0xf775ab24]&gt; dr eip=0xf775a785</span><br><span class="line">0xf775ab24 -&gt;0xf775a785</span><br><span class="line">[0xf775ab24]&gt; dc</span><br><span class="line">TUCTF&#123;l0c4l_&lt;\_r3m073\_3x3cu710n&#125;</span><br></pre></td></tr></table></figure>
<p>Flag : <code>TUCTF{l0c4l_&lt;_r3m073_3x3cu710n}</code></p>
<h1 id="Unknown"><a href="#Unknown" class="headerlink" title="Unknown"></a>Unknown</h1><blockquote>
<p>Diggin through some old files we discovered this binary. Although despite our inspection we can’t figure out what it does. Or what it wants…</p>
</blockquote>
<p>Input hashed per character and check if character hash same with some constant. Solution, drop the character hash when its being compared. Recover the flag from constant and known hash from dropped hash.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># defacto lib</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">import</span> r2pipe</span><br><span class="line"><span class="keyword">except</span> ImportError <span class="keyword">as</span> err:</span><br><span class="line">    print(<span class="string">"Error while importing module r2pipe: %s"</span> % str(err))</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">unk_401DAC = [</span><br><span class="line">    <span class="number">0xFDFAB57A</span>,<span class="number">0x032449A7</span>,<span class="number">0x5F383821</span>,<span class="number">0xFDFAB57A</span>,</span><br><span class="line">    <span class="number">0x25435E02</span>,<span class="number">0x59E2EB0D</span>,<span class="number">0x5ED756D7</span>,<span class="number">0x5CFFF023</span>,</span><br><span class="line">    <span class="number">0x9239BDF3</span>,<span class="number">0xF62C7F9B</span>,<span class="number">0x63E13F5F</span>,<span class="number">0xD6338E84</span>,</span><br><span class="line">    <span class="number">0x5CFFF023</span>,<span class="number">0xFF20BDEF</span>,<span class="number">0xC51F928E</span>,<span class="number">0x63E13F5F</span>,</span><br><span class="line">    <span class="number">0xFF20BDEF</span>,<span class="number">0xC51F928E</span>,<span class="number">0xB59D1071</span>,<span class="number">0xF62C7F9B</span>,</span><br><span class="line">    <span class="number">0xC51F928E</span>,<span class="number">0x388D9870</span>,<span class="number">0xFF20BDEF</span>,<span class="number">0xCEECC5BA</span>,</span><br><span class="line">    <span class="number">0xA952136B</span>,<span class="number">0x96710841</span>,<span class="number">0xFF20BDEF</span>,<span class="number">0xC51F928E</span>,</span><br><span class="line">    <span class="number">0xF536DFFD</span>,<span class="number">0xCEECC5BA</span>,<span class="number">0xA952136B</span>,<span class="number">0xC5D7DAC4</span>,</span><br><span class="line">    <span class="number">0xFF20BDEF</span>,<span class="number">0x12A92A61</span>,<span class="number">0x63E13F5F</span>,<span class="number">0xB59D1071</span>,</span><br><span class="line">    <span class="number">0xFF20BDEF</span>,<span class="number">0x388D9870</span>,<span class="number">0x63E13F5F</span>,<span class="number">0xCD78354E</span>,</span><br><span class="line">    <span class="number">0xFF20BDEF</span>,<span class="number">0xF2184419</span>,<span class="number">0xCEECC5BA</span>,<span class="number">0xCD78354E</span>,</span><br><span class="line">    <span class="number">0xC51F928E</span>,<span class="number">0x3CA8BFDC</span>,<span class="number">0xF62C7F9B</span>,<span class="number">0x3CA8BFDC</span>,</span><br><span class="line">    <span class="number">0xF2184419</span>,<span class="number">0xCEECC5BA</span>,<span class="number">0xC51F928E</span>,<span class="number">0x3CA8BFDC</span>,</span><br><span class="line">    <span class="number">0xA952136B</span>,<span class="number">0x2FF35144</span>,<span class="number">0xBA165EA7</span>,<span class="number">0xEF1B84CD</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"># Stage 1 -- Recover the hashes --</span></span><br><span class="line"><span class="string">alpha = [ 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123', '456789!()[]_-,.PADPADPADPADPADPADPADPADPADPADPADPADPADPA' ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for key in alpha:</span></span><br><span class="line"><span class="string">    r2 = r2pipe.open('./unknown')</span></span><br><span class="line"><span class="string">    r2.cmd('ood ' + key)</span></span><br><span class="line"><span class="string">    r2.cmd('db 0x401f20') # break on \`cmp eax, ecx\`</span></span><br><span class="line"><span class="string">    for i in key:</span></span><br><span class="line"><span class="string">        r2.cmd('dc')</span></span><br><span class="line"><span class="string">        regs = r2.cmdj('drj')</span></span><br><span class="line"><span class="string">        # dump the hash into table</span></span><br><span class="line"><span class="string">        print '[\\'' + i + '\\' ,' + hex(regs['rax']) + ']'</span></span><br><span class="line"><span class="string">    r2.quit()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage 2 -- Recover the flag using known character hashes table --</span></span><br><span class="line">hashes = [ [<span class="string">'0'</span> ,<span class="number">0x63e13f5f</span>],</span><br><span class="line">[<span class="string">'1'</span> ,<span class="number">0x3ca8bfdc</span>],</span><br><span class="line">[<span class="string">'2'</span> ,<span class="number">0xdd0e6ec0</span>],</span><br><span class="line">[<span class="string">'3'</span> ,<span class="number">0x5cfff023</span>],</span><br><span class="line">[<span class="string">'4'</span> ,<span class="number">0xceecc5ba</span>],</span><br><span class="line">[<span class="string">'5'</span> ,<span class="number">0xcc1be317</span>],</span><br><span class="line">[<span class="string">'6'</span> ,<span class="number">0x2ff35144</span>],</span><br><span class="line">[<span class="string">'7'</span> ,<span class="number">0xc51f928e</span>],</span><br><span class="line">[<span class="string">'8'</span> ,<span class="number">0xb6705910</span>],</span><br><span class="line">[<span class="string">'9'</span> ,<span class="number">0x26552da4</span>],</span><br><span class="line">[<span class="string">'A'</span> ,<span class="number">0x65d4bb53</span>],</span><br><span class="line">[<span class="string">'B'</span> ,<span class="number">0x62fe8700</span>],</span><br><span class="line">[<span class="string">'C'</span> ,<span class="number">0x5f383821</span>],</span><br><span class="line">[<span class="string">'D'</span> ,<span class="number">0x70e9ce39</span>],</span><br><span class="line">[<span class="string">'E'</span> ,<span class="number">0x5f9b4d91</span>],</span><br><span class="line">[<span class="string">'F'</span> ,<span class="number">0x25435e02</span>],</span><br><span class="line">[<span class="string">'G'</span> ,<span class="number">0x51beb40a</span>],</span><br><span class="line">[<span class="string">'H'</span> ,<span class="number">0x82d03951</span>],</span><br><span class="line">[<span class="string">'I'</span> ,<span class="number">0x1bd78865</span>],</span><br><span class="line">[<span class="string">'J'</span> ,<span class="number">0x81d23ebf</span>],</span><br><span class="line">[<span class="string">'K'</span> ,<span class="number">0xb8aa7c13</span>],</span><br><span class="line">[<span class="string">'L'</span> ,<span class="number">0x8e29337c</span>],</span><br><span class="line">[<span class="string">'M'</span> ,<span class="number">0x960c851a</span>],</span><br><span class="line">[<span class="string">'N'</span> ,<span class="number">0x9aecf4a0</span>],</span><br><span class="line">[<span class="string">'O'</span> ,<span class="number">0x3d5214b8</span>],</span><br><span class="line">[<span class="string">'P'</span> ,<span class="number">0xcab235fd</span>],</span><br><span class="line">[<span class="string">'Q'</span> ,<span class="number">0x9c417714</span>],</span><br><span class="line">[<span class="string">'R'</span> ,<span class="number">0x010ef83b</span>],</span><br><span class="line">[<span class="string">'S'</span> ,<span class="number">0x87befa83</span>],</span><br><span class="line">[<span class="string">'T'</span> ,<span class="number">0xfdfab57a</span>],</span><br><span class="line">[<span class="string">'U'</span> ,<span class="number">0x032449a7</span>],</span><br><span class="line">[<span class="string">'V'</span> ,<span class="number">0xe67efe4f</span>],</span><br><span class="line">[<span class="string">'W'</span> ,<span class="number">0x3b957ccc</span>],</span><br><span class="line">[<span class="string">'X'</span> ,<span class="number">0xce39daba</span>],</span><br><span class="line">[<span class="string">'Y'</span> ,<span class="number">0x69844214</span>],</span><br><span class="line">[<span class="string">'Z'</span> ,<span class="number">0xcece4054</span>],</span><br><span class="line">[<span class="string">'a'</span> ,<span class="number">0x3893db85</span>],</span><br><span class="line">[<span class="string">'b'</span> ,<span class="number">0x0faf7ec1</span>],</span><br><span class="line">[<span class="string">'c'</span> ,<span class="number">0xf62c7f9b</span>],</span><br><span class="line">[<span class="string">'d'</span> ,<span class="number">0x96710841</span>],</span><br><span class="line">[<span class="string">'e'</span> ,<span class="number">0xb623c6c1</span>],</span><br><span class="line">[<span class="string">'f'</span> ,<span class="number">0x388d9870</span>],</span><br><span class="line">[<span class="string">'g'</span> ,<span class="number">0x382136b4</span>],</span><br><span class="line">[<span class="string">'h'</span> ,<span class="number">0xf536dffd</span>],</span><br><span class="line">[<span class="string">'i'</span> ,<span class="number">0x67258d77</span>],</span><br><span class="line">[<span class="string">'j'</span> ,<span class="number">0x5019d530</span>],</span><br><span class="line">[<span class="string">'k'</span> ,<span class="number">0xc5d7dac4</span>],</span><br><span class="line">[<span class="string">'l'</span> ,<span class="number">0x9239bdf3</span>],</span><br><span class="line">[<span class="string">'m'</span> ,<span class="number">0xd6338e84</span>],</span><br><span class="line">[<span class="string">'n'</span> ,<span class="number">0xa952136b</span>],</span><br><span class="line">[<span class="string">'o'</span> ,<span class="number">0x408a2c4b</span>],</span><br><span class="line">[<span class="string">'p'</span> ,<span class="number">0xf2184419</span>],</span><br><span class="line">[<span class="string">'q'</span> ,<span class="number">0x2c6485d5</span>],</span><br><span class="line">[<span class="string">'r'</span> ,<span class="number">0xcd78354e</span>],</span><br><span class="line">[<span class="string">'s'</span> ,<span class="number">0x98605ae6</span>],</span><br><span class="line">[<span class="string">'t'</span> ,<span class="number">0xc863df45</span>],</span><br><span class="line">[<span class="string">'u'</span> ,<span class="number">0xb59d1071</span>],</span><br><span class="line">[<span class="string">'v'</span> ,<span class="number">0xa4f459d3</span>],</span><br><span class="line">[<span class="string">'w'</span> ,<span class="number">0x5ed756d7</span>],</span><br><span class="line">[<span class="string">'x'</span> ,<span class="number">0x965ae173</span>],</span><br><span class="line">[<span class="string">'y'</span> ,<span class="number">0x12a92a61</span>],</span><br><span class="line">[<span class="string">'z'</span> ,<span class="number">0xe630810a</span>],</span><br><span class="line">[<span class="string">'_'</span> ,<span class="number">0xff20bdef</span>],</span><br><span class="line">[<span class="string">'&#123;'</span> ,<span class="number">0x59e2eb0d</span>],</span><br><span class="line">[<span class="string">'&#125;'</span> ,<span class="number">0xef1b84cd</span>],</span><br><span class="line">[<span class="string">'!'</span> ,<span class="number">0xba165ea7</span>] ]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> u <span class="keyword">in</span> unk_401DAC:</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> hashes:</span><br><span class="line">        <span class="keyword">if</span> k[<span class="number">1</span>] == u:</span><br><span class="line">            flag += k[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure></p>
<p>Flag : <code>TUCTF{w3lc0m3_70_7uc7f_4nd_7h4nk_y0u_f0r_p4r71c1p471n6!}</code></p>
<h1 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h1><blockquote>
<p>Future me gave me this and told me to add it to TUCTF. I dunno, he sounded crazy. Anyway, Let’s see what’s so special about it.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">genMatrix</span><span class="params">(<span class="keyword">char</span> mat[<span class="number">5</span>][<span class="number">5</span>], <span class="keyword">char</span> str[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">25</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> m = (i * <span class="number">2</span>) % <span class="number">25</span>;</span><br><span class="line">        <span class="keyword">int</span> f = (i * <span class="number">7</span>) % <span class="number">25</span>;</span><br><span class="line">        mat[m/<span class="number">5</span>][m%<span class="number">5</span>] = str[f];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">genAuthString</span><span class="params">(<span class="keyword">char</span> mat[<span class="number">5</span>][<span class="number">5</span>], <span class="keyword">char</span> auth[])</span> </span>&#123;</span><br><span class="line">    auth[<span class="number">0</span>] = mat[<span class="number">0</span>][<span class="number">0</span>] + mat[<span class="number">4</span>][<span class="number">4</span>];</span><br><span class="line">    auth[<span class="number">1</span>] = mat[<span class="number">2</span>][<span class="number">1</span>] + mat[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">2</span>] = mat[<span class="number">4</span>][<span class="number">2</span>] + mat[<span class="number">4</span>][<span class="number">1</span>];</span><br><span class="line">    auth[<span class="number">3</span>] = mat[<span class="number">1</span>][<span class="number">3</span>] + mat[<span class="number">3</span>][<span class="number">1</span>];</span><br><span class="line">    auth[<span class="number">4</span>] = mat[<span class="number">3</span>][<span class="number">4</span>] + mat[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">5</span>] = mat[<span class="number">1</span>][<span class="number">0</span>] + mat[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">    auth[<span class="number">6</span>] = mat[<span class="number">2</span>][<span class="number">4</span>] + mat[<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">    auth[<span class="number">7</span>] = mat[<span class="number">3</span>][<span class="number">3</span>] + mat[<span class="number">3</span>][<span class="number">2</span>] + mat[<span class="number">0</span>][<span class="number">3</span>];</span><br><span class="line">    auth[<span class="number">8</span>] = mat[<span class="number">0</span>][<span class="number">4</span>] + mat[<span class="number">4</span>][<span class="number">0</span>] + mat[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    auth[<span class="number">9</span>] = mat[<span class="number">3</span>][<span class="number">3</span>] + mat[<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">    auth[<span class="number">10</span>] = mat[<span class="number">4</span>][<span class="number">0</span>] + mat[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">11</span>] = mat[<span class="number">0</span>][<span class="number">4</span>] + mat[<span class="number">4</span>][<span class="number">1</span>];</span><br><span class="line">    auth[<span class="number">12</span>] = mat[<span class="number">0</span>][<span class="number">3</span>] + mat[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">13</span>] = mat[<span class="number">3</span>][<span class="number">0</span>] + mat[<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">    auth[<span class="number">14</span>] = mat[<span class="number">1</span>][<span class="number">4</span>] + mat[<span class="number">1</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">15</span>] = mat[<span class="number">4</span>][<span class="number">3</span>] + mat[<span class="number">2</span>][<span class="number">3</span>];</span><br><span class="line">    auth[<span class="number">16</span>] = mat[<span class="number">2</span>][<span class="number">2</span>] + mat[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">    auth[<span class="number">17</span>] = mat[<span class="number">1</span>][<span class="number">1</span>] + mat[<span class="number">4</span>][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> flag[<span class="number">26</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"What's the flag: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%25s"</span>, flag);</span><br><span class="line">    flag[<span class="number">25</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strlen</span>(flag) != <span class="number">25</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Try harder."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Setup matrix</span></span><br><span class="line">    <span class="keyword">char</span> mat[<span class="number">5</span>][<span class="number">5</span>];<span class="comment">// Matrix for a jumbled string</span></span><br><span class="line">    genMatrix(mat, flag);</span><br><span class="line">    <span class="comment">// Generate auth string</span></span><br><span class="line">    <span class="keyword">char</span> auth[<span class="number">19</span>]; <span class="comment">// The auth string they generate</span></span><br><span class="line">    auth[<span class="number">18</span>] = <span class="number">0</span>; <span class="comment">// null byte</span></span><br><span class="line">    genAuthString(mat, auth);</span><br><span class="line">    <span class="keyword">char</span> pass[<span class="number">19</span>] = <span class="string">"\\x8b\\xce\\xb0\\x89\\x7b\\xb0\\xb0\\xee\\xbf\\x92\\x65\\x9d\\x9a\\x99\\x99\\x94\\xad\\xe4\\x00"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check the input</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strcmp</span>(pass, auth)) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Yup thats the flag!"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Nope. Try again."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In this challange, program will calculate our input and check if its same with <code>pass</code> constant. I’m using Z3 smt solver to solve this and add TUCTF flag format as a constraint, because if it isn’t Z3 will give another uintended solution.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line"></span><br><span class="line">const = [<span class="number">0x8b</span>, <span class="number">0xce</span>, <span class="number">0xb0</span>, <span class="number">0x89</span>, <span class="number">0x7b</span>, <span class="number">0xb0</span>, <span class="number">0xb0</span>, <span class="number">0xee</span>, <span class="number">0xbf</span>, <span class="number">0x92</span>, <span class="number">0x65</span>, <span class="number">0x9d</span>, <span class="number">0x9a</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0x94</span>, <span class="number">0xad</span>, <span class="number">0xe4</span>]</span><br><span class="line"></span><br><span class="line">str = [BitVec(i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">25</span>)]</span><br><span class="line"></span><br><span class="line">alpha = string.letters + string.digits + string.punctuation</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> xrange(<span class="number">0xFF</span>):</span><br><span class="line">        <span class="keyword">if</span> chr(x) <span class="keyword">not</span> <span class="keyword">in</span> alpha:</span><br><span class="line">            s.add(str[i] != x)</span><br><span class="line"></span><br><span class="line">s.add(str[<span class="number">0</span>] == ord(<span class="string">'T'</span>))</span><br><span class="line">s.add(str[<span class="number">1</span>] == ord(<span class="string">'U'</span>))</span><br><span class="line">s.add(str[<span class="number">2</span>] == ord(<span class="string">'C'</span>))</span><br><span class="line">s.add(str[<span class="number">3</span>] == ord(<span class="string">'T'</span>))</span><br><span class="line">s.add(str[<span class="number">4</span>] == ord(<span class="string">'F'</span>))</span><br><span class="line">s.add(str[<span class="number">5</span>] == ord(<span class="string">'&#123;'</span>))</span><br><span class="line">s.add(str[<span class="number">24</span>] == ord(<span class="string">'&#125;'</span>))</span><br><span class="line"></span><br><span class="line">s.add(str[<span class="number">0</span>] + str[<span class="number">9</span>] == const[<span class="number">0</span>])</span><br><span class="line">s.add(str[<span class="number">1</span>] + str[<span class="number">7</span>] == const[<span class="number">1</span>])</span><br><span class="line">s.add(str[<span class="number">2</span>] + str[<span class="number">11</span>] == const[<span class="number">2</span>])</span><br><span class="line">s.add(str[<span class="number">3</span>] + str[<span class="number">6</span>] == const[<span class="number">3</span>])</span><br><span class="line">s.add(str[<span class="number">4</span>] + str[<span class="number">12</span>] == const[<span class="number">4</span>])</span><br><span class="line">s.add(str[<span class="number">5</span>] + str[<span class="number">8</span>] == const[<span class="number">5</span>])</span><br><span class="line">s.add(str[<span class="number">24</span>] + str[<span class="number">10</span>] == const[<span class="number">6</span>])</span><br><span class="line">s.add(str[<span class="number">13</span>] + str[<span class="number">22</span>] + str[<span class="number">23</span>] == const[<span class="number">7</span>])</span><br><span class="line">s.add(str[<span class="number">14</span>] + str[<span class="number">20</span>] + str[<span class="number">16</span>] == const[<span class="number">8</span>])</span><br><span class="line">s.add(str[<span class="number">13</span>] + str[<span class="number">10</span>] == const[<span class="number">9</span>])</span><br><span class="line">s.add(str[<span class="number">20</span>] + str[<span class="number">12</span>] == const[<span class="number">10</span>])</span><br><span class="line">s.add(str[<span class="number">14</span>] + str[<span class="number">11</span>] == const[<span class="number">11</span>])</span><br><span class="line">s.add(str[<span class="number">23</span>] + str[<span class="number">7</span>] == const[<span class="number">12</span>])</span><br><span class="line">s.add(str[<span class="number">15</span>] + str[<span class="number">10</span>] == const[<span class="number">13</span>])</span><br><span class="line">s.add(str[<span class="number">19</span>] + str[<span class="number">12</span>] == const[<span class="number">14</span>])</span><br><span class="line">s.add(str[<span class="number">18</span>] + str[<span class="number">8</span>] == const[<span class="number">15</span>])</span><br><span class="line">s.add(str[<span class="number">17</span>] + str[<span class="number">7</span>] == const[<span class="number">16</span>])</span><br><span class="line">s.add(str[<span class="number">21</span>] + str[<span class="number">11</span>] == const[<span class="number">17</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    model = s.model()</span><br><span class="line">    flag = [chr(model[x].as_long()) <span class="keyword">for</span> x <span class="keyword">in</span> str]</span><br><span class="line">    <span class="keyword">print</span> <span class="string">''</span>.join(flag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Nope :('</span></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">mat[0][0] = str[0]</span></span><br><span class="line"><span class="string">mat[2][1] = str[1]</span></span><br><span class="line"><span class="string">mat[4][2] = str[2]</span></span><br><span class="line"><span class="string">mat[1][3] = str[3]</span></span><br><span class="line"><span class="string">mat[3][4] = str[4]</span></span><br><span class="line"><span class="string">mat[1][0] = str[5]</span></span><br><span class="line"><span class="string">mat[3][1] = str[6]</span></span><br><span class="line"><span class="string">mat[0][2] = str[7]</span></span><br><span class="line"><span class="string">mat[2][3] = str[8]</span></span><br><span class="line"><span class="string">mat[4][4] = str[9]</span></span><br><span class="line"><span class="string">mat[2][0] = str[10]</span></span><br><span class="line"><span class="string">mat[4][1] = str[11]</span></span><br><span class="line"><span class="string">mat[1][2] = str[12]</span></span><br><span class="line"><span class="string">mat[3][3] = str[13]</span></span><br><span class="line"><span class="string">mat[0][4] = str[14]</span></span><br><span class="line"><span class="string">mat[3][0] = str[15]</span></span><br><span class="line"><span class="string">mat[0][1] = str[16]</span></span><br><span class="line"><span class="string">mat[2][2] = str[17]</span></span><br><span class="line"><span class="string">mat[4][3] = str[18]</span></span><br><span class="line"><span class="string">mat[1][4] = str[19]</span></span><br><span class="line"><span class="string">mat[4][0] = str[20]</span></span><br><span class="line"><span class="string">mat[1][1] = str[21]</span></span><br><span class="line"><span class="string">mat[3][2] = str[22]</span></span><br><span class="line"><span class="string">mat[0][3] = str[23]</span></span><br><span class="line"><span class="string">mat[2][4] = str[24]</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>Flag : <code>TUCTF{5y573m5_0f_4_d0wn!}</code></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Funmail"><span class="toc-number">1.</span> <span class="toc-text">Funmail</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Funmail2-0"><span class="toc-number">2.</span> <span class="toc-text">Funmail2.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Unknown"><span class="toc-number">3.</span> <span class="toc-text">Unknown</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Future"><span class="toc-number">4.</span> <span class="toc-text">Future</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&text=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&is_video=false&description=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=TUCTF 2017 - Reverse Engineering Writeup&body=Check out this article: https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&title=TUCTF 2017 - Reverse Engineering Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://zeroload.github.io/2017/11/27/tuctf-2017-reverse-engineering-writeup/&name=TUCTF 2017 - Reverse Engineering Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 zeroload
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'zeroload-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


